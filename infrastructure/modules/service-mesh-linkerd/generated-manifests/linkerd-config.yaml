---
###
### Linkerd Namespace
###
---
kind: Namespace
apiVersion: v1
metadata:
  name: linkerd
  annotations:
    linkerd.io/inject: disabled
  labels:
    linkerd.io/is-control-plane: "true"
    config.linkerd.io/admission-webhooks: disabled
    linkerd.io/control-plane-ns: linkerd
---
###
### Identity Controller Service RBAC
###
---
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: linkerd-linkerd-identity
  labels:
    linkerd.io/control-plane-component: identity
    linkerd.io/control-plane-ns: linkerd
rules:
- apiGroups: ["authentication.k8s.io"]
  resources: ["tokenreviews"]
  verbs: ["create"]
- apiGroups: ["apps"]
  resources: ["deployments"]
  verbs: ["get"]
- apiGroups: [""]
  resources: ["events"]
  verbs: ["create", "patch"]
---
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: linkerd-linkerd-identity
  labels:
    linkerd.io/control-plane-component: identity
    linkerd.io/control-plane-ns: linkerd
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: linkerd-linkerd-identity
subjects:
- kind: ServiceAccount
  name: linkerd-identity
  namespace: linkerd
---
kind: ServiceAccount
apiVersion: v1
metadata:
  name: linkerd-identity
  namespace: linkerd
  labels:
    linkerd.io/control-plane-component: identity
    linkerd.io/control-plane-ns: linkerd
---
###
### Controller RBAC
###
---
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: linkerd-linkerd-controller
  labels:
    linkerd.io/control-plane-component: controller
    linkerd.io/control-plane-ns: linkerd
rules:
- apiGroups: ["extensions", "apps"]
  resources: ["daemonsets", "deployments", "replicasets", "statefulsets"]
  verbs: ["list", "get", "watch"]
- apiGroups: ["extensions", "batch"]
  resources: ["cronjobs", "jobs"]
  verbs: ["list" , "get", "watch"]
- apiGroups: [""]
  resources: ["pods", "endpoints", "services", "replicationcontrollers", "namespaces"]
  verbs: ["list", "get", "watch"]
- apiGroups: ["linkerd.io"]
  resources: ["serviceprofiles"]
  verbs: ["list", "get", "watch"]
- apiGroups: ["split.smi-spec.io"]
  resources: ["trafficsplits"]
  verbs: ["list", "get", "watch"]
---
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: linkerd-linkerd-controller
  labels:
    linkerd.io/control-plane-component: controller
    linkerd.io/control-plane-ns: linkerd
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: linkerd-linkerd-controller
subjects:
- kind: ServiceAccount
  name: linkerd-controller
  namespace: linkerd
---
kind: ServiceAccount
apiVersion: v1
metadata:
  name: linkerd-controller
  namespace: linkerd
  labels:
    linkerd.io/control-plane-component: controller
    linkerd.io/control-plane-ns: linkerd
---
###
### Destination Controller Service
###
---
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: linkerd-linkerd-destination
  labels:
    linkerd.io/control-plane-component: destination
    linkerd.io/control-plane-ns: linkerd
rules:
- apiGroups: ["apps"]
  resources: ["replicasets"]
  verbs: ["list", "get", "watch"]
- apiGroups: ["batch"]
  resources: ["jobs"]
  verbs: ["list", "get", "watch"]
- apiGroups: [""]
  resources: ["pods", "endpoints", "services"]
  verbs: ["list", "get", "watch"]
- apiGroups: ["linkerd.io"]
  resources: ["serviceprofiles"]
  verbs: ["list", "get", "watch"]
- apiGroups: ["split.smi-spec.io"]
  resources: ["trafficsplits"]
  verbs: ["list", "get", "watch"]
---
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: linkerd-linkerd-destination
  labels:
    linkerd.io/control-plane-component: destination
    linkerd.io/control-plane-ns: linkerd
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: linkerd-linkerd-destination
subjects:
- kind: ServiceAccount
  name: linkerd-destination
  namespace: linkerd
---
kind: ServiceAccount
apiVersion: v1
metadata:
  name: linkerd-destination
  namespace: linkerd
  labels:
    linkerd.io/control-plane-component: destination
    linkerd.io/control-plane-ns: linkerd
---
###
### Heartbeat RBAC
###
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: linkerd-heartbeat
  namespace: linkerd
  labels:
    linkerd.io/control-plane-ns: linkerd
rules:
- apiGroups: [""]
  resources: ["configmaps"]
  verbs: ["get"]
  resourceNames: ["linkerd-config"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: linkerd-heartbeat
  namespace: linkerd
  labels:
    linkerd.io/control-plane-ns: linkerd
roleRef:
  kind: Role
  name: linkerd-heartbeat
  apiGroup: rbac.authorization.k8s.io
subjects:
- kind: ServiceAccount
  name: linkerd-heartbeat
  namespace: linkerd
---
kind: ServiceAccount
apiVersion: v1
metadata:
  name: linkerd-heartbeat
  namespace: linkerd
  labels:
    linkerd.io/control-plane-component: heartbeat
    linkerd.io/control-plane-ns: linkerd
---
###
### Web RBAC
###
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: linkerd-web
  namespace: linkerd
  labels:
    linkerd.io/control-plane-component: web
    linkerd.io/control-plane-ns: linkerd
rules:
- apiGroups: [""]
  resources: ["configmaps"]
  verbs: ["get"]
  resourceNames: ["linkerd-config"]
- apiGroups: [""]
  resources: ["namespaces", "configmaps"]
  verbs: ["get"]
- apiGroups: [""]
  resources: ["serviceaccounts", "pods"]
  verbs: ["list"]
- apiGroups: ["apps"]
  resources: ["replicasets"]
  verbs: ["list"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: linkerd-web
  namespace: linkerd
  labels:
    linkerd.io/control-plane-component: web
    linkerd.io/control-plane-ns: linkerd
roleRef:
  kind: Role
  name: linkerd-web
  apiGroup: rbac.authorization.k8s.io
subjects:
- kind: ServiceAccount
  name: linkerd-web
  namespace: linkerd
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: linkerd-linkerd-web-check
  labels:
    linkerd.io/control-plane-component: web
    linkerd.io/control-plane-ns: linkerd
rules:
- apiGroups: ["rbac.authorization.k8s.io"]
  resources: ["clusterroles", "clusterrolebindings"]
  verbs: ["list"]
- apiGroups: ["apiextensions.k8s.io"]
  resources: ["customresourcedefinitions"]
  verbs: ["list"]
- apiGroups: ["admissionregistration.k8s.io"]
  resources: ["mutatingwebhookconfigurations", "validatingwebhookconfigurations"]
  verbs: ["list"]
- apiGroups: ["policy"]
  resources: ["podsecuritypolicies"]
  verbs: ["list"]
- apiGroups: ["linkerd.io"]
  resources: ["serviceprofiles"]
  verbs: ["list"]
- apiGroups: ["apiregistration.k8s.io"]
  resources: ["apiservices"]
  verbs: ["get"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: linkerd-linkerd-web-check
  labels:
    linkerd.io/control-plane-component: web
    linkerd.io/control-plane-ns: linkerd
roleRef:
  kind: ClusterRole
  name: linkerd-linkerd-web-check
  apiGroup: rbac.authorization.k8s.io
subjects:
- kind: ServiceAccount
  name: linkerd-web
  namespace: linkerd
---
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: linkerd-linkerd-web-admin
  labels:
    linkerd.io/control-plane-component: web
    linkerd.io/control-plane-ns: linkerd
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: linkerd-linkerd-tap-admin
subjects:
- kind: ServiceAccount
  name: linkerd-web
  namespace: linkerd
---
kind: ServiceAccount
apiVersion: v1
metadata:
  name: linkerd-web
  namespace: linkerd
  labels:
    linkerd.io/control-plane-component: web
    linkerd.io/control-plane-ns: linkerd
---
###
### Service Profile CRD
###
---
apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  name: serviceprofiles.linkerd.io
  annotations:
    linkerd.io/created-by: linkerd/cli stable-2.8.1
  labels:
    linkerd.io/control-plane-ns: linkerd
spec:
  group: linkerd.io
  versions:
  - name: v1alpha1
    served: true
    storage: false
  - name: v1alpha2
    served: true
    storage: true
  scope: Namespaced
  names:
    plural: serviceprofiles
    singular: serviceprofile
    kind: ServiceProfile
    shortNames:
    - sp
---
###
### TrafficSplit CRD
### Copied from https://github.com/deislabs/smi-sdk-go/blob/cea7e1e9372304bbb6c74a3f6ca788d9eaa9cc58/crds/split.yaml
###
---
apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  name: trafficsplits.split.smi-spec.io
  annotations:
    linkerd.io/created-by: linkerd/cli stable-2.8.1
  labels:
    linkerd.io/control-plane-ns: linkerd
spec:
  group: split.smi-spec.io
  version: v1alpha1
  scope: Namespaced
  names:
    kind: TrafficSplit
    shortNames:
      - ts
    plural: trafficsplits
    singular: trafficsplit
  additionalPrinterColumns:
  - name: Service
    type: string
    description: The apex service of this split.
    JSONPath: .spec.service
---
###
### Prometheus RBAC
###
---
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: linkerd-linkerd-prometheus
  labels:
    linkerd.io/control-plane-component: prometheus
    linkerd.io/control-plane-ns: linkerd
rules:
- apiGroups: [""]
  resources: ["nodes", "nodes/proxy", "pods"]
  verbs: ["get", "list", "watch"]
---
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: linkerd-linkerd-prometheus
  labels:
    linkerd.io/control-plane-component: prometheus
    linkerd.io/control-plane-ns: linkerd
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: linkerd-linkerd-prometheus
subjects:
- kind: ServiceAccount
  name: linkerd-prometheus
  namespace: linkerd
---
kind: ServiceAccount
apiVersion: v1
metadata:
  name: linkerd-prometheus
  namespace: linkerd
  labels:
    linkerd.io/control-plane-component: prometheus
    linkerd.io/control-plane-ns: linkerd
---
###
### Proxy Injector RBAC
###
---
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: linkerd-linkerd-proxy-injector
  labels:
    linkerd.io/control-plane-component: proxy-injector
    linkerd.io/control-plane-ns: linkerd
rules:
- apiGroups: [""]
  resources: ["events"]
  verbs: ["create", "patch"]
- apiGroups: [""]
  resources: ["namespaces", "replicationcontrollers"]
  verbs: ["list", "get", "watch"]
- apiGroups: [""]
  resources: ["pods"]
  verbs: ["list", "watch"]
- apiGroups: ["extensions", "apps"]
  resources: ["deployments", "replicasets", "daemonsets", "statefulsets"]
  verbs: ["list", "get", "watch"]
- apiGroups: ["extensions", "batch"]
  resources: ["cronjobs", "jobs"]
  verbs: ["list", "get", "watch"]
---
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: linkerd-linkerd-proxy-injector
  labels:
    linkerd.io/control-plane-component: proxy-injector
    linkerd.io/control-plane-ns: linkerd
subjects:
- kind: ServiceAccount
  name: linkerd-proxy-injector
  namespace: linkerd
  apiGroup: ""
roleRef:
  kind: ClusterRole
  name: linkerd-linkerd-proxy-injector
  apiGroup: rbac.authorization.k8s.io
---
kind: ServiceAccount
apiVersion: v1
metadata:
  name: linkerd-proxy-injector
  namespace: linkerd
  labels:
    linkerd.io/control-plane-component: proxy-injector
    linkerd.io/control-plane-ns: linkerd
---
kind: Secret
apiVersion: v1
metadata:
  name: linkerd-proxy-injector-tls
  namespace: linkerd
  labels:
    linkerd.io/control-plane-component: proxy-injector
    linkerd.io/control-plane-ns: linkerd
  annotations:
    linkerd.io/created-by: linkerd/cli stable-2.8.1
type: Opaque
data:
  crt.pem: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURKakNDQWc2Z0F3SUJBZ0lRUFc5VUdFTDNpVzdIY2NWUkc2c2tXVEFOQmdrcWhraUc5dzBCQVFzRkFEQXQKTVNzd0tRWURWUVFERXlKc2FXNXJaWEprTFhCeWIzaDVMV2x1YW1WamRHOXlMbXhwYm10bGNtUXVjM1pqTUI0WApEVEl3TVRBd09ERXdNVEl5T1ZvWERUSXhNVEF3T0RFd01USXlPVm93TFRFck1Da0dBMVVFQXhNaWJHbHVhMlZ5ClpDMXdjbTk0ZVMxcGJtcGxZM1J2Y2k1c2FXNXJaWEprTG5OMll6Q0NBU0l3RFFZSktvWklodmNOQVFFQkJRQUQKZ2dFUEFEQ0NBUW9DZ2dFQkFPUDJsUkxkaXVEcGV5L1R1YXNLV0JLNTB2YkVCYkhqKzY4VXZvclhpNFJ4LzgyNQpTTGtPZXlQdWlRV29aYW1GTlZvM0NGWkNqYWFrRXJadUQxTkdzQlM1SVRQZmZyOStXZTR2bS9ybHJLSjBvTjZlCkJsUm5ldWRhbmNLVUhmYU0rZHR1ZDcrY0xaQ1pwaHdHcEFGYWxMT0xlTmJ6VCtXdU5manNQUGMvbnVYR0NwUm8Kd3FhZHJrc0RXbTByTDJST0ErYnN1RGJmSG9RWXJjbDl0MVdRSCs5ZW9TMEhURm44QkdrdWVFU2YrRjdrM2V6Ygo0OUFkUzRUcHdHSkh2Yy9JUWx4LzZwQ0Y1c0wwTDFXUnRMSDlQQkxGZnBiYVpEMVE1RmFkM2FHYlQrY29WNEVWCmlPbUluUGZxTGF1d3NEWlZaOGVpV0NXbHJSTlpVL3dyZFFlNUVYc0NBd0VBQWFOQ01FQXdEZ1lEVlIwUEFRSC8KQkFRREFnS2tNQjBHQTFVZEpRUVdNQlFHQ0NzR0FRVUZCd01CQmdnckJnRUZCUWNEQWpBUEJnTlZIUk1CQWY4RQpCVEFEQVFIL01BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQWREUkY3Q2E2U2d1NmtsbkduOElKbjNWeWxJNEpBCnZOVDhPN01TZXp2WVdHTU9UZ0pWTUFTRG13STRma0xxTXZFanVzTTRkUFVBSWtoQWdCS0dzYkc5QVNGako5T2MKVVVCc3NXY1RvbTExVzIxbkYyTkFNUVJHL2RDcm9YSWhsWnB0WjlhdmtVeklCOXM1TGNGZGRzOUp2TEl6Y0cvQwpZRlVFcnVlYjVHdUx0UzhsYnVuWkxzcVBodHZISklzeTkvdFNCT05TanZxNmFMN3owQkxFUldaRC9ISmZZU3RPCmI1bmlWTktpVXVQRjN0a2M0ZVFVa2ZFd0NtYjF2YS9YODBFaE9xL3QzMXA2bUR3Skw0djkvSnA2N2YrKzJENTMKODNQT0E5RGJiTFJqaEdicTczcWdTUVVLTGMxZHVWRDNQekFVcDRHU2JJblZZL3MxRENZVWxPeW4KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
  key.pem: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBNC9hVkV0Mks0T2w3TDlPNXF3cFlFcm5TOXNRRnNlUDdyeFMraXRlTGhISC96YmxJCnVRNTdJKzZKQmFobHFZVTFXamNJVmtLTnBxUVN0bTRQVTBhd0ZMa2hNOTkrdjM1WjdpK2IrdVdzb25TZzNwNEcKVkdkNjUxcWR3cFFkOW96NTIyNTN2NXd0a0ptbUhBYWtBVnFVczR0NDF2TlA1YTQxK093ODl6K2U1Y1lLbEdqQwpwcDJ1U3dOYWJTc3ZaRTRENXV5NE50OGVoQml0eVgyM1ZaQWY3MTZoTFFkTVdmd0VhUzU0UkovNFh1VGQ3TnZqCjBCMUxoT25BWWtlOXo4aENYSC9xa0lYbXd2UXZWWkcwc2YwOEVzVitsdHBrUFZEa1ZwM2RvWnRQNXloWGdSV0kKNllpYzkrb3RxN0N3TmxWbng2SllKYVd0RTFsVC9DdDFCN2tSZXdJREFRQUJBb0lCQUFOMUgvbXpSb0gyeUptSApHby9QamxwcVd4ckhDbGNTWUNUZHFhNHRhcjVOaEZXNGM3UHExazlMTk9UVEV3ZXBMNC80dWJXbE9NVElSRWhrCkR2TnlaUVZMY1lkNTRsQkJPRmYyZk9VblNxRUVKOVI0alJ3R25jU1lpVUFFUXhnVU4wM3V0UDVBL2lmdFRLbXMKS0J5bEpSQThFMDhmVFp6c01ZRmZBK1cwSDFMWTBNWWhBL0dxUWpJc1I1RU1ySDE1MSsyM1FNSzF6OG5Xb0NteApBL2FTOXhOZGJSTytHTWNhakQyNDhtOXYvdEtCYkJ3RklJY0NCMHpKODJkeUlBM2xTWXNkTEZWZWtONGM2bE1OCmdLV3hhQVhKMWpxcDdIQWxMMWpybkg3TXprM2lWOG9Ba283YnBCSEgwUjRLbkFvT3lRa2pySm4ya2VVcVM5VlAKVnFCMHN0RUNnWUVBL1cxUXJ0MjB1YzFJMVhGTjZXeVRvS1BTTG5zMGUxSFlteXk0bXQ1L0JmRmpnQUIzTGhwVQpCQjZmSG16cjlZZS9Qc2NKem5OQUFuRWNhanVWaFl4MmY1K1lRR3hackRKTk1YUDVZVWk4akJ0eWIyWXliUkFyCmsydHNyb0puUTMrVXZpTzhqYmFlRlJXWmNyQktmYmsreU5Ub3pxM1dWdk9PNHlmTEpQL2RUWjBDZ1lFQTVrY1YKZTZob045dGFRNzE1K3JuVXo0dHRXRXM2dkFMQlhEQk1KMk5CR0Z5ZzMvakFaeFVUMHVUSCtHUTJReGtEKzM0WgpCbVB1dUNCYmM2cXVPbEZsZW9XYkR2V1ZQd2FwK0RrMGVid3JJSGFXaUJ0L2dUUHdaSGNNdzF5dDF5d3Nxa1lUClRMclpTMENiTC9HdXpkL0YvREx0b0wyUGdHNEpCazZxZ0lDUU8vY0NnWUVBM3RUMHdaMHQ0TVd4U2dRamhxQ3kKdWVmeDBtOEF1WUpBM0VpWlZZdFgwMGpwdlU0cmZQMG5iS3ZrSzJPSW9rNm5DVE1IMjJDWklzeUVPS0NGbTNUagphTnBTakNyNU9pRE1vVFFoVGJvZ0YyMjIxRjdlN2VqdTkrUFlIeVdJV09CZ1VFT3A4azFsZUpLU1p6YTllUWllClBRYUFZZUtXZWNRVW1vV042TTJWc0QwQ2dZRUF4SFZRdHJidWN2a0pBVkhkaHpLVGhKMkhKQlRLZnl3Nm10UDUKcElEaFFFK0dVSTZBVjNGOEFDaC9Fa01zcUFIbmkrQUFxWnNJUnI0VVI1SU9JbUxmR0xCem9VZVRsTG15dUxyVgpNaVovQktzbnNlY0QyTTdmQUZjdzVGdGxWSFd6aFhGVGRkclRGNGgrM1dCcnFlaUhtS282WVRCWUJWSGJFUzU3CitEVzIxL0VDZ1lCU2JpMTM1TUFrQzFkQVBqZnhNQ3NtN2dJcTJNZzdVSHoyWW1NblZmYkdtbXpTTDFrMXM0WDEKZE9CdnFRYjhTUngvVE1LTm1ydnNQMHhWcXd4aGJSR3oxandIL0JWU0dUOXBhTGhvRWRxSjNSVjl1RVNERHlyVQpPb3pPZVZIc1BBd2ErK0MzT2cvZUFlUnhmRGEwWVIxVWhUaTlzdHVnN0ZmNXRaR283N2piS2c9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=
---
apiVersion: admissionregistration.k8s.io/v1beta1
kind: MutatingWebhookConfiguration
metadata:
  name: linkerd-proxy-injector-webhook-config
  labels:
    linkerd.io/control-plane-component: proxy-injector
    linkerd.io/control-plane-ns: linkerd
webhooks:
- name: linkerd-proxy-injector.linkerd.io
  namespaceSelector:
    matchExpressions:
    - key: config.linkerd.io/admission-webhooks
      operator: NotIn
      values:
      - disabled
  clientConfig:
    service:
      name: linkerd-proxy-injector
      namespace: linkerd
      path: "/"
    caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURKakNDQWc2Z0F3SUJBZ0lRUFc5VUdFTDNpVzdIY2NWUkc2c2tXVEFOQmdrcWhraUc5dzBCQVFzRkFEQXQKTVNzd0tRWURWUVFERXlKc2FXNXJaWEprTFhCeWIzaDVMV2x1YW1WamRHOXlMbXhwYm10bGNtUXVjM1pqTUI0WApEVEl3TVRBd09ERXdNVEl5T1ZvWERUSXhNVEF3T0RFd01USXlPVm93TFRFck1Da0dBMVVFQXhNaWJHbHVhMlZ5ClpDMXdjbTk0ZVMxcGJtcGxZM1J2Y2k1c2FXNXJaWEprTG5OMll6Q0NBU0l3RFFZSktvWklodmNOQVFFQkJRQUQKZ2dFUEFEQ0NBUW9DZ2dFQkFPUDJsUkxkaXVEcGV5L1R1YXNLV0JLNTB2YkVCYkhqKzY4VXZvclhpNFJ4LzgyNQpTTGtPZXlQdWlRV29aYW1GTlZvM0NGWkNqYWFrRXJadUQxTkdzQlM1SVRQZmZyOStXZTR2bS9ybHJLSjBvTjZlCkJsUm5ldWRhbmNLVUhmYU0rZHR1ZDcrY0xaQ1pwaHdHcEFGYWxMT0xlTmJ6VCtXdU5manNQUGMvbnVYR0NwUm8Kd3FhZHJrc0RXbTByTDJST0ErYnN1RGJmSG9RWXJjbDl0MVdRSCs5ZW9TMEhURm44QkdrdWVFU2YrRjdrM2V6Ygo0OUFkUzRUcHdHSkh2Yy9JUWx4LzZwQ0Y1c0wwTDFXUnRMSDlQQkxGZnBiYVpEMVE1RmFkM2FHYlQrY29WNEVWCmlPbUluUGZxTGF1d3NEWlZaOGVpV0NXbHJSTlpVL3dyZFFlNUVYc0NBd0VBQWFOQ01FQXdEZ1lEVlIwUEFRSC8KQkFRREFnS2tNQjBHQTFVZEpRUVdNQlFHQ0NzR0FRVUZCd01CQmdnckJnRUZCUWNEQWpBUEJnTlZIUk1CQWY4RQpCVEFEQVFIL01BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQWREUkY3Q2E2U2d1NmtsbkduOElKbjNWeWxJNEpBCnZOVDhPN01TZXp2WVdHTU9UZ0pWTUFTRG13STRma0xxTXZFanVzTTRkUFVBSWtoQWdCS0dzYkc5QVNGako5T2MKVVVCc3NXY1RvbTExVzIxbkYyTkFNUVJHL2RDcm9YSWhsWnB0WjlhdmtVeklCOXM1TGNGZGRzOUp2TEl6Y0cvQwpZRlVFcnVlYjVHdUx0UzhsYnVuWkxzcVBodHZISklzeTkvdFNCT05TanZxNmFMN3owQkxFUldaRC9ISmZZU3RPCmI1bmlWTktpVXVQRjN0a2M0ZVFVa2ZFd0NtYjF2YS9YODBFaE9xL3QzMXA2bUR3Skw0djkvSnA2N2YrKzJENTMKODNQT0E5RGJiTFJqaEdicTczcWdTUVVLTGMxZHVWRDNQekFVcDRHU2JJblZZL3MxRENZVWxPeW4KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
  failurePolicy: Ignore
  rules:
  - operations: [ "CREATE" ]
    apiGroups: [""]
    apiVersions: ["v1"]
    resources: ["pods"]
  sideEffects: None
---
###
### Service Profile Validator RBAC
###
---
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: linkerd-linkerd-sp-validator
  labels:
    linkerd.io/control-plane-component: sp-validator
    linkerd.io/control-plane-ns: linkerd
rules:
- apiGroups: [""]
  resources: ["pods"]
  verbs: ["list"]
---
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: linkerd-linkerd-sp-validator
  labels:
    linkerd.io/control-plane-component: sp-validator
    linkerd.io/control-plane-ns: linkerd
subjects:
- kind: ServiceAccount
  name: linkerd-sp-validator
  namespace: linkerd
  apiGroup: ""
roleRef:
  kind: ClusterRole
  name: linkerd-linkerd-sp-validator
  apiGroup: rbac.authorization.k8s.io
---
kind: ServiceAccount
apiVersion: v1
metadata:
  name: linkerd-sp-validator
  namespace: linkerd
  labels:
    linkerd.io/control-plane-component: sp-validator
    linkerd.io/control-plane-ns: linkerd
---
kind: Secret
apiVersion: v1
metadata:
  name: linkerd-sp-validator-tls
  namespace: linkerd
  labels:
    linkerd.io/control-plane-component: sp-validator
    linkerd.io/control-plane-ns: linkerd
  annotations:
    linkerd.io/created-by: linkerd/cli stable-2.8.1
type: Opaque
data:
  crt.pem: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURJekNDQWd1Z0F3SUJBZ0lSQU9ETm9PTmxWVFRsb243dVYwNHo5YWN3RFFZSktvWklodmNOQVFFTEJRQXcKS3pFcE1DY0dBMVVFQXhNZ2JHbHVhMlZ5WkMxemNDMTJZV3hwWkdGMGIzSXViR2x1YTJWeVpDNXpkbU13SGhjTgpNakF4TURBNE1UQXhNakk1V2hjTk1qRXhNREE0TVRBeE1qSTVXakFyTVNrd0p3WURWUVFERXlCc2FXNXJaWEprCkxYTndMWFpoYkdsa1lYUnZjaTVzYVc1clpYSmtMbk4yWXpDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVAKQURDQ0FRb0NnZ0VCQUszN1ljVWpZWHIyRFAzZlhsK01SSDJnQjJhd0l2SjlPajVLSHNnK2haWGJaWmlBL3k4VQpTdkhudTZGbmVDenJVa0RXQU1mOUlGUnh4SXh5VlZSRFB5anV5bEM1VXcyb2l2aFZsbWtVUDFuQ3VHaGVqbTRSCkp4N1FnS202QmZSU0ZRS1dwZC9jVHNweXpBS2JMeUYxL0hMWWwyVng4TlJxZHZZdnRrTG1GV3ZVbGJ1MWp3a0kKbDRnN2ZHRWpnTFFFcTRtNFdjZDZUbFRUTjFqUTFvUTFvZmIwNTkwMEhveVAySVBXcUJVKzVNUWhoeUVJQ0lRcQpKamdnOVFaRFpZZWp3SFZBRFZYWUVCRDJyOWVjcnVna3l1bGhJV1htbDU3NllmRzRacmlWVXJxaGxhOFZoRXcwCkpjNythRENyclBJd1ZNaUFnTEFiUURGbGh3YzYwK09Vd2RrQ0F3RUFBYU5DTUVBd0RnWURWUjBQQVFIL0JBUUQKQWdLa01CMEdBMVVkSlFRV01CUUdDQ3NHQVFVRkJ3TUJCZ2dyQmdFRkJRY0RBakFQQmdOVkhSTUJBZjhFQlRBRApBUUgvTUEwR0NTcUdTSWIzRFFFQkN3VUFBNElCQVFDV2syVGltY0psdHBUZEJRbVJVUnh0Vmp0cE93S3BSYXc5ClFxbEpIMHRYQ3MwNWlEaGxjcDlxNU14SW9DS2paWWFlY1B5Q1lnMlhHaVEzcmZpYWRMbVl3L21ZQzdVUGNhclIKZWlkUmlLUlZZWEhMRlpjV1F0bWpUdXJubGM0YnJ3a0l4WlBXU2NqQ25xQmRDY0g2R3Z2VzJHOXNGNmRNWDludwpMTUVHbTM4MFFFQUxnZUJkd2p6bGg1M0FSVENBRVdyT3o2dWJ4cmowV3BOVlVUeGZkR3VQSERrYldVWWdLdEFCCjF1NUlBZjZXMWdIUDBDMXhhNS80VVhzTzhvQm1SSWxaK1BDOUowdUh6MVVOYVJEVGlqaExWNHRXWXZUVFVUOUEKVmpTM29hVkJ4VnY3czRXQW41Rmd1c2kra09DT043WWlGMFpLVWR4LzF0dkh3d3M1SGVFMAotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
  key.pem: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb2dJQkFBS0NBUUVBcmZ0aHhTTmhldllNL2Q5ZVg0eEVmYUFIWnJBaThuMDZQa29leUQ2RmxkdGxtSUQvCkx4Uks4ZWU3b1dkNExPdFNRTllBeC8wZ1ZISEVqSEpWVkVNL0tPN0tVTGxURGFpSytGV1dhUlEvV2NLNGFGNk8KYmhFbkh0Q0FxYm9GOUZJVkFwYWwzOXhPeW5MTUFwc3ZJWFg4Y3RpWFpYSHcxR3AyOWkrMlF1WVZhOVNWdTdXUApDUWlYaUR0OFlTT0F0QVNyaWJoWngzcE9WTk0zV05EV2hEV2g5dlRuM1RRZWpJL1lnOWFvRlQ3a3hDR0hJUWdJCmhDb21PQ0QxQmtObGg2UEFkVUFOVmRnUUVQYXYxNXl1NkNUSzZXRWhaZWFYbnZwaDhiaG11SlZTdXFHVnJ4V0UKVERRbHp2NW9NS3VzOGpCVXlJQ0FzQnRBTVdXSEJ6clQ0NVRCMlFJREFRQUJBb0lCQUhDRklPRlBsWTdock50UAo2QWdoZm5aRTFpU0tpNytLVCszVEgvOWZ1Q09JSmpld1RkbVQ1VGg0SjdnbVkrbWhNNndzKzRwYjRkbmJUa09LCitqYXAyeUpNOVZtcDBkWUdpQUk5MEM0Yll6RlpKc3lSUXNwYW01TnBRNTBCYXpKdEY1dDU5TU5JQjBrVlgyM2MKRVdveGxWaHRUZFRWRU8xQUFib01kM0xpdlQzanlRaUJ1blZjSkdGbjJDQXQ2Y1M5MEJtVEJlMzdodyswU0Y5ZwplMmw0eW9rUHlwQTNXczZGYXAwMHZJcVVwZkVzbVhlQytlMlpKSWdJMDRTZWg2a3ZWMElLUjZ6RGd6TjRaK0I4ClVNVDVQRnNNbGJoOUVUTlRLRGgyTS9yOWdyRkFRQ3Y1bGNsRnR0SVlucm96cnNoZjBhVjZaYVgrQ2dvZ0k1V2sKOHM4bm9DVUNnWUVBMVFiU0FoSHZRUm5NaE9ZdWl2b1NHaXpSRDU5c0RZVkFFcW15WWdEdTVUS3FDTWI3aFJkWgpTY0s5N25pemE5ZUQ0blZpMS9udjVTWm9MTHd4VEhESmxtclIwUDJGT0toZm9FSmhzR1VKQVYyRkcrZkZNeDExCmwxWjdGSUxjejM1Nm92SUk1R2ZIeEp6QUJqUmd4cjRFTkY1ZEFyamsxcEhqVVVPNWEzbEIrUU1DZ1lFQTBSUTAKbmpidVJsL0ViWDVFT0srOGxBOTFvTmpDNzRsekpNSXpKaVZPaDF6MFRlQktvL0dlL2dSZDEwRFhITkU2VFRUWQpKc0lIamdFSm1zaEJZM1crb0RKTDZ6dzhyL2x0dU0xOW5sVGE3RkR2VUc5YnNvYlJ6di9yOFhsZFJyZUYza2V5Ck1PWDluck9SR0FXMldVSEo1TjJlNlBqRVJWaTdlYzNkNENZdHpQTUNnWUJsYkxqaWVXMkRmbWdNd3BkWVhoWHUKVm5ZM1RQMGlOdFk1eklmODkxckd6MmQ3aEZuT2xUNVN5eUNwQU5qVU9LazNVaEo4cUNoYTN2MXNoekdscG5Hawpaemw4bXFncVFLZys0andtd3dRVm5WUTU1QkRVOUdxL1lsSjVncERsVGQvUDR4THV4S2F0YXNCV2MrdTcxRTZtCkxHTjJYMWU4L1hyUWYwRXg5V3EreHdLQmdEQUlSRTVVc0VqYWwzWFFIRHdwbzFrZ2RCV1B0cmp4Q3RMWENva28KNlBHUUdWQUt4eHNDMTFQa0RPcjJxblNrWEpDQUkyaEVDeGhFaE1CYVlTdElVWkxiK3pUL2tiR2J5K2s0ekRNagpxMmUrOER1NldZYWFFbmxMc2hpM21RWTJBenNkbllJK1ZCV3hpeFBKdkNxbFFveWhuWEJJTms3NEk1bklBY0VOCkJGaWhBb0dBZHJVRWtsUnJrdk5Oc3VGaGI2MHYxNEthRWx5T0EzMUJmaVVOYXJVU0JCT3cyV2cwUk9hTnhXclEKcSsxYUR6UzVsOHVGN2dFR2Y4V1U4RzltRGs2RTBFb1Eydldqc3Fob0lvVHpDNm1QYlVlUHVlT29QTGdqVE1hSgp6OStXN1NIamtXYi96WmVkL0ZYOTNaZjlhMTVZRmNXbnd1R2thZWNLTWY2MjViTEFWQWs9Ci0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==
---
apiVersion: admissionregistration.k8s.io/v1beta1
kind: ValidatingWebhookConfiguration
metadata:
  name: linkerd-sp-validator-webhook-config
  labels:
    linkerd.io/control-plane-component: sp-validator
    linkerd.io/control-plane-ns: linkerd
webhooks:
- name: linkerd-sp-validator.linkerd.io
  namespaceSelector:
    matchExpressions:
    - key: config.linkerd.io/admission-webhooks
      operator: NotIn
      values:
      - disabled
  clientConfig:
    service:
      name: linkerd-sp-validator
      namespace: linkerd
      path: "/"
    caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURJekNDQWd1Z0F3SUJBZ0lSQU9ETm9PTmxWVFRsb243dVYwNHo5YWN3RFFZSktvWklodmNOQVFFTEJRQXcKS3pFcE1DY0dBMVVFQXhNZ2JHbHVhMlZ5WkMxemNDMTJZV3hwWkdGMGIzSXViR2x1YTJWeVpDNXpkbU13SGhjTgpNakF4TURBNE1UQXhNakk1V2hjTk1qRXhNREE0TVRBeE1qSTVXakFyTVNrd0p3WURWUVFERXlCc2FXNXJaWEprCkxYTndMWFpoYkdsa1lYUnZjaTVzYVc1clpYSmtMbk4yWXpDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVAKQURDQ0FRb0NnZ0VCQUszN1ljVWpZWHIyRFAzZlhsK01SSDJnQjJhd0l2SjlPajVLSHNnK2haWGJaWmlBL3k4VQpTdkhudTZGbmVDenJVa0RXQU1mOUlGUnh4SXh5VlZSRFB5anV5bEM1VXcyb2l2aFZsbWtVUDFuQ3VHaGVqbTRSCkp4N1FnS202QmZSU0ZRS1dwZC9jVHNweXpBS2JMeUYxL0hMWWwyVng4TlJxZHZZdnRrTG1GV3ZVbGJ1MWp3a0kKbDRnN2ZHRWpnTFFFcTRtNFdjZDZUbFRUTjFqUTFvUTFvZmIwNTkwMEhveVAySVBXcUJVKzVNUWhoeUVJQ0lRcQpKamdnOVFaRFpZZWp3SFZBRFZYWUVCRDJyOWVjcnVna3l1bGhJV1htbDU3NllmRzRacmlWVXJxaGxhOFZoRXcwCkpjNythRENyclBJd1ZNaUFnTEFiUURGbGh3YzYwK09Vd2RrQ0F3RUFBYU5DTUVBd0RnWURWUjBQQVFIL0JBUUQKQWdLa01CMEdBMVVkSlFRV01CUUdDQ3NHQVFVRkJ3TUJCZ2dyQmdFRkJRY0RBakFQQmdOVkhSTUJBZjhFQlRBRApBUUgvTUEwR0NTcUdTSWIzRFFFQkN3VUFBNElCQVFDV2syVGltY0psdHBUZEJRbVJVUnh0Vmp0cE93S3BSYXc5ClFxbEpIMHRYQ3MwNWlEaGxjcDlxNU14SW9DS2paWWFlY1B5Q1lnMlhHaVEzcmZpYWRMbVl3L21ZQzdVUGNhclIKZWlkUmlLUlZZWEhMRlpjV1F0bWpUdXJubGM0YnJ3a0l4WlBXU2NqQ25xQmRDY0g2R3Z2VzJHOXNGNmRNWDludwpMTUVHbTM4MFFFQUxnZUJkd2p6bGg1M0FSVENBRVdyT3o2dWJ4cmowV3BOVlVUeGZkR3VQSERrYldVWWdLdEFCCjF1NUlBZjZXMWdIUDBDMXhhNS80VVhzTzhvQm1SSWxaK1BDOUowdUh6MVVOYVJEVGlqaExWNHRXWXZUVFVUOUEKVmpTM29hVkJ4VnY3czRXQW41Rmd1c2kra09DT043WWlGMFpLVWR4LzF0dkh3d3M1SGVFMAotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
  failurePolicy: Ignore
  rules:
  - operations: [ "CREATE" , "UPDATE" ]
    apiGroups: ["linkerd.io"]
    apiVersions: ["v1alpha1", "v1alpha2"]
    resources: ["serviceprofiles"]
  sideEffects: None
---
###
### Tap RBAC
###
---
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: linkerd-linkerd-tap
  labels:
    linkerd.io/control-plane-component: tap
    linkerd.io/control-plane-ns: linkerd
rules:
- apiGroups: [""]
  resources: ["pods", "services", "replicationcontrollers", "namespaces", "nodes"]
  verbs: ["list", "get", "watch"]
- apiGroups: ["extensions", "apps"]
  resources: ["daemonsets", "deployments", "replicasets", "statefulsets"]
  verbs: ["list", "get", "watch"]
- apiGroups: ["extensions", "batch"]
  resources: ["cronjobs", "jobs"]
  verbs: ["list" , "get", "watch"]
---
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: linkerd-linkerd-tap-admin
  labels:
    linkerd.io/control-plane-component: tap
    linkerd.io/control-plane-ns: linkerd
rules:
- apiGroups: ["tap.linkerd.io"]
  resources: ["*"]
  verbs: ["watch"]
---
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: linkerd-linkerd-tap
  labels:
    linkerd.io/control-plane-component: tap
    linkerd.io/control-plane-ns: linkerd
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: linkerd-linkerd-tap
subjects:
- kind: ServiceAccount
  name: linkerd-tap
  namespace: linkerd
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: linkerd-linkerd-tap-auth-delegator
  labels:
    linkerd.io/control-plane-component: tap
    linkerd.io/control-plane-ns: linkerd
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: system:auth-delegator
subjects:
- kind: ServiceAccount
  name: linkerd-tap
  namespace: linkerd
---
kind: ServiceAccount
apiVersion: v1
metadata:
  name: linkerd-tap
  namespace: linkerd
  labels:
    linkerd.io/control-plane-component: tap
    linkerd.io/control-plane-ns: linkerd
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: linkerd-linkerd-tap-auth-reader
  namespace: kube-system
  labels:
    linkerd.io/control-plane-component: tap
    linkerd.io/control-plane-ns: linkerd
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: extension-apiserver-authentication-reader
subjects:
- kind: ServiceAccount
  name: linkerd-tap
  namespace: linkerd
---
kind: Secret
apiVersion: v1
metadata:
  name: linkerd-tap-tls
  namespace: linkerd
  labels:
    linkerd.io/control-plane-component: tap
    linkerd.io/control-plane-ns: linkerd
  annotations:
    linkerd.io/created-by: linkerd/cli stable-2.8.1
type: Opaque
data:
  crt.pem: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURFRENDQWZpZ0F3SUJBZ0lRVHdzcGNVRjM2U3kyc0JydkwxbjdPakFOQmdrcWhraUc5dzBCQVFzRkFEQWkKTVNBd0hnWURWUVFERXhkc2FXNXJaWEprTFhSaGNDNXNhVzVyWlhKa0xuTjJZekFlRncweU1ERXdNRGd4TURFeQpNamxhRncweU1URXdNRGd4TURFeU1qbGFNQ0l4SURBZUJnTlZCQU1URjJ4cGJtdGxjbVF0ZEdGd0xteHBibXRsCmNtUXVjM1pqTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUF2NktXMGVzYnVUb3oKNmZmeXB1U1Q3MTJJTE01bUhZTDdxSXN1N0cwajhVc0ZmUjBpRGE4V1pJc2Z3Z3N2Y1lrK3I5alFHSDJ2QzJLVApEVG53UVpjL3FZcmxzUE1CeVBtNzlkaFNPcEwzL1VNbkcxUHZZRTRPL1dKeGNhOWFTajBlamRUTExTSmdBMW0xCmd2d1N1bTdWUndhTXY2bm13bzIwT2p0d3pMQ1llZ2NJbDJyNG4wSHpSazBkTE5sYzQyQ040Z2QrN1cxNmZoVU4KWXpqSFMzRzdNZzNBSjU3VDFKT0RYRXpncnFNamIxNTd5eVUzSWdUOGdVSVdDNGEwalVqWUI1RzlvMmY3alRwRgpKUytySFdVTnZxYnFZVFdFc0U3alNZZWVuVFN4N3hCVkZVcG5zc1IxOUF6TzIyOXh4cG80R1Y2cml6bDRVSUJtClczTGQ0Y3FMcVFJREFRQUJvMEl3UURBT0JnTlZIUThCQWY4RUJBTUNBcVF3SFFZRFZSMGxCQll3RkFZSUt3WUIKQlFVSEF3RUdDQ3NHQVFVRkJ3TUNNQThHQTFVZEV3RUIvd1FGTUFNQkFmOHdEUVlKS29aSWh2Y05BUUVMQlFBRApnZ0VCQUdnUzFuQ0RXdnlrUkpsM2J0ZjlIeUk1VHEzdXFEUVQ4eUNmZEMyTDA0YTJkTGdtcHBtRks1bE1RRkJBCnNxTVpyMnhUYllMYWd0STEyMkV6SC9wYVd3QXZtb1hkVDRNWmR2UEkzQ25mNUx0aFhQSmtLVHVMYVM2b0QvU0sKRE1LV21RM0lXdVM2aTNxMmdRV2tvbWJXWWpXMUtIUExDYXR2dHlESG5sMHpEcm5aUkVoV2RQVkIxdmwxeU5RZgpmMkpBUE9UM3hELzh6UXdGTkVucXl5cXhmSHZZUUxLY2FZeVo4d003ekhYWTd4REFJcHl6M0N2V0pKcmYyUExyCjRNaUZvOVgzQnF4azhPUTNDQkVMc3dUYlIwYkNnL2YxM0VWMnpIM0pPa3NIb1AwSHNEYXZZaVRac05kNlZoUFEKbUhtWVNNTEd4TnUwVEZQamp5anJkMVJUUXFRPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
  key.pem: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBdjZLVzBlc2J1VG96NmZmeXB1U1Q3MTJJTE01bUhZTDdxSXN1N0cwajhVc0ZmUjBpCkRhOFdaSXNmd2dzdmNZaytyOWpRR0gydkMyS1REVG53UVpjL3FZcmxzUE1CeVBtNzlkaFNPcEwzL1VNbkcxUHYKWUU0Ty9XSnhjYTlhU2owZWpkVExMU0pnQTFtMWd2d1N1bTdWUndhTXY2bm13bzIwT2p0d3pMQ1llZ2NJbDJyNApuMEh6UmswZExObGM0MkNONGdkKzdXMTZmaFVOWXpqSFMzRzdNZzNBSjU3VDFKT0RYRXpncnFNamIxNTd5eVUzCklnVDhnVUlXQzRhMGpVallCNUc5bzJmN2pUcEZKUytySFdVTnZxYnFZVFdFc0U3alNZZWVuVFN4N3hCVkZVcG4Kc3NSMTlBek8yMjl4eHBvNEdWNnJpemw0VUlCbVczTGQ0Y3FMcVFJREFRQUJBb0lCQUh5UUM2YkJRdEVBY3hRbQoxZlFEYWVGU0U1ekVRSDM0VU9vNkpqTUpzaTQ2aklQSnR3UGNCaHN1ajJNSzhEakZkQmpMUG1CYytiWFZ5aTN6CnRpWjhVS1k4b1phR0xtZmJaSUNscnJWaUtJM1g0NGlRNDJ6ZThFRmxoc1hWckVQTFBKd0djRmFUSElPeEFSbjIKRFpwZlJvU1hUaythK1dNR3h0cC9Iby8rVGU0cW1jWVpTenRlZm5ua1lVUVE2cERPeU5zcGFVdUErNm9aQWt0Zgo0L2FLTHI3dU13YUxKanZwRUZvdEJYZUY4ZFp5SXZGYXhyMzFkZUpKQ1h2VHRPUFVLQzBMTXdJWlRrMEJHOGYvCmpvYUlvZStWa2h5Ris0V1d1bHRBYWFiQXFuQ1NxWDlvTm01T2dZeGR6Q2lNbC9zOEpMbUtjd2dBYjJGcUtBbXcKZi9MM2VrMENnWUVBNnl4MTJsNkdhb1I1N0dnZXJpekdPTWEyWFdnMGN3WjJRaUI5c3NQNGxIVXMrUzRxSzBkVwpKQUsxN0pEVG14QlNPRzFyQSt4Y29CQXNjWHJFTi9PZ01uMUJZODFHSFpWMkoyTURTVlBCdUIyZXc1MmJ3STNrCjhvMzZkSU85ZFpZMkZnUE11Z0hkY3d2dUZNYTdhOCs4TEJjaHVnRXZ2VnlRa1BJRUpDVmpSSzhDZ1lFQTBKc1UKMXlzTHVlL1NvWE5VTy9UNnpLa2ZTUDlkWkU3YWhUWVY2eEVkV3FFaDRuL241NDRtd2N2eFdlRHA0Mm5QcGhCTwo2VXRCTTlNcEdtT2UrTnNvQjlmTjlMQXhOb2RHK0JQOXVJamczUDRPYTlNMDh6S1lreHc2WnRyV3FubnZNMy9qClE3cFU2NmdYcUJGM0w0VnhWenRnS1hTRzc4SndhcmFyZDAzRmV5Y0NnWUVBbDRDdys5amhaMFdvOWkrdGRDL00KRTArUXRHUXBSZURuMW5ud0FIWlhjZXg2Nkp4ZzlqaWl1ZGcxTXcycUJMOWkrSThrM2dZck5jSzFudldqNnhlOApJRXFwRVk1d21TWnNVN3RwcHBlYXVPMzhGYkUzWWJrSHdXck42cm5rR0JpSkIyMnpPakZ4WkdoUEhIdGF5bjJ0CmtBbm01RmxYVS9xSjk1YXlMRWNaeUdrQ2dZQWV3NUFxUDBYbWNQRE9NSlR1bHExWisyTUt2K1pGQWNBR1B6aXkKUnY3ZU83OGtpUnBwTXJTU2hnSWM4Q2R1QzArOVBOQjJaVXZEV2RQSStZSWJUeTZ6SVdkVk81cTJZUExkYVExVQo1cExLNUlpNTdCYjErck0zbHNVaUlBbmljRU1QaEQrKzREN2YxaFZQQ3V4WnpNTXZTeWxlVTdvR3A5VXVWNnduCjF3ZFZwd0tCZ1FDU2QvTFVBeTJObDBxdkpDWC9FVUVzU0gwZ2FaZ1JmUmMyMDBPUXBydFQ4UmRkTVFBUmhDOGMKWkc0YXNsdnFGaXVWbmdPS2dmUmJna29ER214eEVlZml0bTVlcEVjd2k2UlBSR3Ewais2aXdKWVFHSnpHemtRMQpWUjA1REEzY0tKREMwNURwVGN0MjVEYVlGaTdkVXVMQTZJYUllb3FpSk1TMFpKSDg3bmRSanc9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=
---
apiVersion: apiregistration.k8s.io/v1
kind: APIService
metadata:
  name: v1alpha1.tap.linkerd.io
  labels:
    linkerd.io/control-plane-component: tap
    linkerd.io/control-plane-ns: linkerd
spec:
  group: tap.linkerd.io
  version: v1alpha1
  groupPriorityMinimum: 1000
  versionPriority: 100
  service:
    name: linkerd-tap
    namespace: linkerd
  caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURFRENDQWZpZ0F3SUJBZ0lRVHdzcGNVRjM2U3kyc0JydkwxbjdPakFOQmdrcWhraUc5dzBCQVFzRkFEQWkKTVNBd0hnWURWUVFERXhkc2FXNXJaWEprTFhSaGNDNXNhVzVyWlhKa0xuTjJZekFlRncweU1ERXdNRGd4TURFeQpNamxhRncweU1URXdNRGd4TURFeU1qbGFNQ0l4SURBZUJnTlZCQU1URjJ4cGJtdGxjbVF0ZEdGd0xteHBibXRsCmNtUXVjM1pqTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUF2NktXMGVzYnVUb3oKNmZmeXB1U1Q3MTJJTE01bUhZTDdxSXN1N0cwajhVc0ZmUjBpRGE4V1pJc2Z3Z3N2Y1lrK3I5alFHSDJ2QzJLVApEVG53UVpjL3FZcmxzUE1CeVBtNzlkaFNPcEwzL1VNbkcxUHZZRTRPL1dKeGNhOWFTajBlamRUTExTSmdBMW0xCmd2d1N1bTdWUndhTXY2bm13bzIwT2p0d3pMQ1llZ2NJbDJyNG4wSHpSazBkTE5sYzQyQ040Z2QrN1cxNmZoVU4KWXpqSFMzRzdNZzNBSjU3VDFKT0RYRXpncnFNamIxNTd5eVUzSWdUOGdVSVdDNGEwalVqWUI1RzlvMmY3alRwRgpKUytySFdVTnZxYnFZVFdFc0U3alNZZWVuVFN4N3hCVkZVcG5zc1IxOUF6TzIyOXh4cG80R1Y2cml6bDRVSUJtClczTGQ0Y3FMcVFJREFRQUJvMEl3UURBT0JnTlZIUThCQWY4RUJBTUNBcVF3SFFZRFZSMGxCQll3RkFZSUt3WUIKQlFVSEF3RUdDQ3NHQVFVRkJ3TUNNQThHQTFVZEV3RUIvd1FGTUFNQkFmOHdEUVlKS29aSWh2Y05BUUVMQlFBRApnZ0VCQUdnUzFuQ0RXdnlrUkpsM2J0ZjlIeUk1VHEzdXFEUVQ4eUNmZEMyTDA0YTJkTGdtcHBtRks1bE1RRkJBCnNxTVpyMnhUYllMYWd0STEyMkV6SC9wYVd3QXZtb1hkVDRNWmR2UEkzQ25mNUx0aFhQSmtLVHVMYVM2b0QvU0sKRE1LV21RM0lXdVM2aTNxMmdRV2tvbWJXWWpXMUtIUExDYXR2dHlESG5sMHpEcm5aUkVoV2RQVkIxdmwxeU5RZgpmMkpBUE9UM3hELzh6UXdGTkVucXl5cXhmSHZZUUxLY2FZeVo4d003ekhYWTd4REFJcHl6M0N2V0pKcmYyUExyCjRNaUZvOVgzQnF4azhPUTNDQkVMc3dUYlIwYkNnL2YxM0VWMnpIM0pPa3NIb1AwSHNEYXZZaVRac05kNlZoUFEKbUhtWVNNTEd4TnUwVEZQamp5anJkMVJUUXFRPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
---
###
### Control Plane PSP
###
---
apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: linkerd-linkerd-control-plane
  labels:
    linkerd.io/control-plane-ns: linkerd
spec:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  allowedCapabilities:
  - NET_ADMIN
  - NET_RAW
  requiredDropCapabilities:
  - ALL
  hostNetwork: false
  hostIPC: false
  hostPID: false
  seLinux:
    rule: RunAsAny
  runAsUser:
    rule: RunAsAny
  supplementalGroups:
    rule: MustRunAs
    ranges:
    - min: 1
      max: 65535
  fsGroup:
    rule: MustRunAs
    ranges:
    - min: 1
      max: 65535
  volumes:
  - configMap
  - emptyDir
  - secret
  - projected
  - downwardAPI
  - persistentVolumeClaim
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: linkerd-psp
  namespace: linkerd
  labels:
    linkerd.io/control-plane-ns: linkerd
rules:
- apiGroups: ['policy', 'extensions']
  resources: ['podsecuritypolicies']
  verbs: ['use']
  resourceNames:
  - linkerd-linkerd-control-plane
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: linkerd-psp
  namespace: linkerd
  labels:
    linkerd.io/control-plane-ns: linkerd
roleRef:
  kind: Role
  name: linkerd-psp
  apiGroup: rbac.authorization.k8s.io
subjects:
- kind: ServiceAccount
  name: linkerd-controller
  namespace: linkerd
- kind: ServiceAccount
  name: linkerd-destination
  namespace: linkerd
- kind: ServiceAccount
  name: linkerd-grafana
  namespace: linkerd
- kind: ServiceAccount
  name: linkerd-heartbeat
  namespace: linkerd
- kind: ServiceAccount
  name: linkerd-identity
  namespace: linkerd
- kind: ServiceAccount
  name: linkerd-prometheus
  namespace: linkerd
- kind: ServiceAccount
  name: linkerd-proxy-injector
  namespace: linkerd
- kind: ServiceAccount
  name: linkerd-sp-validator
  namespace: linkerd
- kind: ServiceAccount
  name: linkerd-tap
  namespace: linkerd
- kind: ServiceAccount
  name: linkerd-web
  namespace: linkerd

---
###
### Grafana RBAC
###
---
kind: ServiceAccount
apiVersion: v1
metadata:
  name: linkerd-grafana
  namespace: linkerd
  labels:
    linkerd.io/control-plane-component: grafana
    linkerd.io/control-plane-ns: linkerd
